<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <title>Binary Search Tree Visualization</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>

<header>
    <h1>Binary Search Tree Visualization</h1>
</header>

<main>
    <div class="container">
        <h2>Binary Search Tree Input</h2>

        <div class="input-group">
            <input type="text" id="numbers" placeholder="e.g. 2,4,1,3,5">
            <div class="button-group">
                <button onclick="submitNumbers()">Submit</button>
                <button onclick="window.location.href='/previous-trees'">Show Previous</button>
            </div>
        </div>

        <pre id="output"></pre>
    </div>
</main>

<footer>
    <p>&copy; 2024 Binary Search Tree Visualization App</p>
</footer>

</body>
</html>

<script>
    function submitNumbers() {
        const nums = document.getElementById("numbers").value
            .split(',')
            .map(n => parseInt(n.trim()));

        fetch("/api/tree/process-numbers", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({ numbers: nums })  // Send the numbers in the correct format
        })
        .then(res => res.json())
        .then(data => {
            // Display the response
            document.getElementById("output").textContent = JSON.stringify(data, null, 2);
        })
        .catch(err => {
            console.error("Error:", err);
            document.getElementById("output").textContent = "Error occurred while processing.";
        });
    }

    function viewPrevious() {
    fetch("/api/tree/history")
        .then(res => res.json())
        .then(data => {
            const container = document.getElementById("previous-tree-list");
            container.innerHTML = "";

            if (data.length === 0) {
                container.textContent = "No previous trees found.";
                container.style.color = "red";
                return;
            }

            container.style.color = "";
            const ul = document.createElement("ul");
            data.forEach(record => {
                const li = document.createElement("li");
                li.innerHTML = `<strong>Input:</strong> ${record.inputNumbers}<br><strong>Tree:</strong> ${record.treeStructure}`;
                ul.appendChild(li);
            });
            container.appendChild(ul);
        })
        .catch(err => {
            console.error("Error loading previous trees:", err);
            const container = document.getElementById("previous-tree-list");
            container.textContent = "Error loading previous trees.";
            container.style.color = "red";
        });
    }
</script>